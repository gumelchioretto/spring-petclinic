pipeline {
    agent any
    
    stages {
    
        stage("Build") {
            steps {
                // Lance la commande pour construire le projet Maven
                sh "./mvnw clean package" // Ajout de "clean" pour s'assurer qu'il n'y a pas de conflits avec les artefacts précédents
            }
        }
    
        stage("Capture") {
            steps {
                // Archive les artefacts JAR générés
                archiveArtifacts '**/target/*.jar'
                
                // Analyser la couverture de code si JaCoCo est configuré dans le pom.xml
                jacoco() // Assurez-vous que JaCoCo est configuré correctement dans le projet

                // Publie les résultats des tests JUnit
                junit '**/target/surefire-reports/*.xml'
            }
        }
    }
}
